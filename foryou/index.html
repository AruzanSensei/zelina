<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>For You Page Generator</title>
    
</head>
<body>
  <div class="dots-background"></div>
  <nav class="breadcrumb">
      <a href="../">âœ¨</a>
      <span>/</span>
      <span href="../">foryou</span>
  </nav>

  <div class="page-wrapper">
    <div class="container">
      <h1>For You Page Generator</h1>
      <p class="subtitle">Buat halaman spesial untuk orang terkasih dengan mudah</p>
    </div>

    <div class="container">
      <form id="generatorForm">
          <div class="form-group">
              <label for="folderName">Penerima</label>
              <input type="text" id="folderName" required
                      placeholder="Contoh: "
                      pattern="[a-zA-Z0-9-]+"
                      title="Gunakan huruf, angka, dan tanda strip saja">
          </div>

          <div class="form-group">
              <label for="pageTitle">Judul Tab Browser</label>
              <input type="text" id="pageTitle" required
                      placeholder="Contoh: Semangat!">
          </div>

          <div class="form-group">
              <label for="headerTitle">Judul Halaman</label>
              <input type="text" id="headerTitle" required
                      placeholder="Contoh: Semangat!ðŸ’ª">
          </div>

          <div class="form-group">
              <label for="message">Pesan</label>
              <textarea id="message" required
                        placeholder="Tulis pesan spesial kamu di sini..."></textarea>
          </div>

          <div class="form-group">
              <label for="senderName">Nama Pengirim</label>
              <input type="text" id="senderName" required
                      placeholder="Contoh: kakak mu">
          </div>

          <div class="form-group">
              <label for="buttonText">Teks Tombol</label>
              <input type="text" id="buttonText" required
                      placeholder="Contoh: Tekan tombol ini dong">
          </div>

          <div class="form-group">
              <label for="footnote">Catatan Kecil (opsional)</label>
              <input type="text" id="footnote"
                      placeholder="Contoh: semoga kamu baca surat ini :)">
          </div>

          <button type="submit">Generate Page âœ¨</button>
      </form>

      <!-- <div class="preview-section">
          <h2 class="preview-title">Preview Halaman</h2>
          <div class="preview-container">
              <div class="preview-content">
                  <h1 id="previewHeaderTitle">Judul akan muncul di sini</h1>
                  <div class="preview-message">
                      <p id="previewMessage">Pesan akan muncul di sini</p>
                      <p id="previewSignature">-<span id="previewSender">pengirim</span></p>
                      <p id="previewFootnote"></p>
                  </div>
                  <button id="previewButton">Teks tombol</button>
              </div>
          </div>
      </div>
  </div> -->
  </div>

    <script>
      const form = document.getElementById('generatorForm');
      
      // Auto-resize textarea
      function autoResize(textarea) {
        textarea.style.height = 'auto';
        textarea.style.height = textarea.scrollHeight + 'px';
      }
      
      // Apply auto-resize to message textarea
      const messageTextarea = document.getElementById('message');
      if (messageTextarea) {
        messageTextarea.addEventListener('input', function() {
          autoResize(this);
        });
        // Initial resize
        autoResize(messageTextarea);
      }
      
      function updatePreview() {
        // Update all preview elements
        document.getElementById('previewHeaderTitle').textContent = 
          document.getElementById('headerTitle').value || 'Judul akan muncul di sini';
        
        document.getElementById('previewMessage').textContent = 
          document.getElementById('message').value || 'Pesan akan muncul di sini';
        
        document.getElementById('previewSender').textContent = 
          document.getElementById('senderName').value || 'pengirim';
        
        document.getElementById('previewFootnote').textContent = 
          document.getElementById('footnote').value;
        
        document.getElementById('previewButton').textContent = 
          document.getElementById('buttonText').value || 'Teks tombol';
      }    // Update preview as user types
    form.querySelectorAll('input, textarea').forEach(input => {
      input.addEventListener('input', updatePreview);
    });

    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      const folderName = document.getElementById('folderName').value;
      const title = document.getElementById('title').value;
      const description = document.getElementById('description').value;

      try {
        // Create the config object
        const config = {
          title,
          description
        };

        // Create folder and files
        const folderPath = `./${folderName}`;
        
        // Attempt to create the directory
        const response = await fetch('/api/create-page', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({
            folderName,
            config
          })
        });

        if (response.ok) {
          alert('Page created successfully!');
          window.location.href = folderPath;
        } else {
          throw new Error('Failed to create page');
        }
      } catch (error) {
        console.error('Error:', error);
        alert('Failed to create page. Please try again.');
      }
    });
  </script>
</body>
</html>